/*! For license information please see 241.22d55c82.chunk.js.LICENSE.txt */
(self.webpackChunkreact_complete_guide=self.webpackChunkreact_complete_guide||[]).push([[241],{872:function(e,t,r){"use strict";r.d(t,{eI:function(){return nt}});var n=r(165);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var a={"X-Client-Info":"supabase-js/".concat("1.35.7")};var c=r(611);function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,c.Z)(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var l=r(2);function f(e,t){if(t&&("object"===(0,l.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f(this,r)}}var p={"X-Client-Info":"gotrue-js/".concat("1.24.0")},v="Request Failed",m=10,y=2,b="supabase.auth.token",k={name:"sb",lifetime:28800,domain:"",path:"/",sameSite:"lax"},g=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},w=function(e){return e.msg||e.message||e.error_description||e.error||JSON.stringify(e)},x=function(e,t){return(null===e||void 0===e?void 0:e.status)?"function"!==typeof e.json?t(e):void e.json().then((function(r){return t({message:w(r),status:(null===e||void 0===e?void 0:e.status)||500})})):t({message:v})},_=function(e,t,r){var n={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e||(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),n.body=JSON.stringify(r)),n};function T(e,t,r,i,o){return g(this,void 0,void 0,(0,n.Z)().mark((function s(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,s){e(r,_(t,i,o)).then((function(e){if(!e.ok)throw e;return(null===i||void 0===i?void 0:i.noResolveJson)?n:e.json()})).then((function(e){return n(e)})).catch((function(e){return x(e,s)}))})));case 1:case"end":return n.stop()}}),s)})))}function S(e,t,r){return g(this,void 0,void 0,(0,n.Z)().mark((function i(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",T(e,"GET",t,r));case 1:case"end":return n.stop()}}),i)})))}function E(e,t,r,i){return g(this,void 0,void 0,(0,n.Z)().mark((function o(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",T(e,"POST",t,i,r));case 1:case"end":return n.stop()}}),o)})))}function O(e,t,r,i){return g(this,void 0,void 0,(0,n.Z)().mark((function o(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",T(e,"PUT",t,i,r));case 1:case"end":return n.stop()}}),o)})))}function j(e,t,r,i){return g(this,void 0,void 0,(0,n.Z)().mark((function o(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",T(e,"DELETE",t,i,r));case 1:case"end":return n.stop()}}),o)})))}function P(e,t){var r,n,i;return function(e,t,r){var n=r||{},i=encodeURIComponent,o=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if("function"!==typeof i)throw new TypeError("option encode is invalid");if(!o.test(e))throw new TypeError("argument name is invalid");var s=i(t);if(s&&!o.test(s))throw new TypeError("argument val is invalid");var a=e+"="+s;if(null!=n.maxAge){var c=n.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(c)}if(n.domain){if(!o.test(n.domain))throw new TypeError("option domain is invalid");a+="; Domain="+n.domain}if(n.path){if(!o.test(n.path))throw new TypeError("option path is invalid");a+="; Path="+n.path}if(n.expires){if("function"!==typeof n.expires.toUTCString)throw new TypeError("option expires is invalid");a+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(a+="; HttpOnly"),n.secure&&(a+="; Secure"),n.sameSite)switch("string"===typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}(e.name,e.value,{maxAge:e.maxAge,expires:new Date(Date.now()+1e3*e.maxAge),httpOnly:!0,secure:t,path:null!==(r=e.path)&&void 0!==r?r:"/",domain:null!==(n=e.domain)&&void 0!==n?n:"",sameSite:null!==(i=e.sameSite)&&void 0!==i?i:"lax"})}function Z(e,t,r){var n=r.map((function(t){return P(t,function(e){if(!e||!e.headers||!e.headers.host)throw new Error('The "host" request header is not available');var t=e.headers.host.indexOf(":")>-1&&e.headers.host.split(":")[0]||e.headers.host;return!(["localhost","127.0.0.1"].indexOf(t)>-1||t.endsWith(".local"))}(e))})),i=t.getHeader("Set-Cookie");return i&&(i instanceof Array?Array.prototype.push.apply(n,i):"string"===typeof i&&n.push(i)),n}function R(e,t,r){t.setHeader("Set-Cookie",Z(e,t,r))}var A=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};function C(e){return Math.round(Date.now()/1e3)+e}var I=function(){return"undefined"!==typeof window};function U(e,t){var r;t||(t=(null===(r=null===window||void 0===window?void 0:window.location)||void 0===r?void 0:r.href)||""),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&#]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}var N=function(e){var t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return A(void 0,void 0,void 0,(0,n.Z)().mark((function e(){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(255).then(r.t.bind(r,255,23));case 2:return e.next=4,(i=e.sent).fetch.apply(i,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))}:fetch),function(){return t.apply(void 0,arguments)}},L=function(e,t){return A(void 0,void 0,void 0,(0,n.Z)().mark((function r(){var i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=I(),!r.t0){r.next=5;break}return r.next=4,null===e||void 0===e?void 0:e.getItem(t);case 4:r.t0=r.sent;case 5:if(i=r.t0){r.next=8;break}return r.abrupt("return",null);case 8:return r.prev=8,r.abrupt("return",JSON.parse(i));case 12:return r.prev=12,r.t1=r.catch(8),r.abrupt("return",i);case 15:case"end":return r.stop()}}),r,null,[[8,12]])})))},D=function(e,t){return A(void 0,void 0,void 0,(0,n.Z)().mark((function r(){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=I(),!r.t0){r.next=4;break}return r.next=4,null===e||void 0===e?void 0:e.removeItem(t);case 4:case"end":return r.stop()}}),r)})))},G=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},M=function(){function e(t){var r=t.url,n=void 0===r?"":r,o=t.headers,s=void 0===o?{}:o,a=t.cookieOptions,c=t.fetch;i(this,e),this.url=n,this.headers=s,this.cookieOptions=Object.assign(Object.assign({},k),a),this.fetch=N(c)}return s(e,[{key:"_createRequestHeaders",value:function(e){var t=Object.assign({},this.headers);return t.Authorization="Bearer ".concat(e),t}},{key:"cookieName",value:function(){var e;return null!==(e=this.cookieOptions.name)&&void 0!==e?e:""}},{key:"getUrlForProvider",value:function(e,t){var r=["provider=".concat(encodeURIComponent(e))];if((null===t||void 0===t?void 0:t.redirectTo)&&r.push("redirect_to=".concat(encodeURIComponent(t.redirectTo))),(null===t||void 0===t?void 0:t.scopes)&&r.push("scopes=".concat(encodeURIComponent(t.scopes))),null===t||void 0===t?void 0:t.queryParams){var n=new URLSearchParams(t.queryParams);r.push("".concat(n))}return"".concat(this.url,"/authorize?").concat(r.join("&"))}},{key:"signUpWithEmail",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function i(){var o,s,a,c;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=Object.assign({},this.headers),s="",r.redirectTo&&(s="?redirect_to="+encodeURIComponent(r.redirectTo)),n.next=6,E(this.fetch,"".concat(this.url,"/signup").concat(s),{email:e,password:t,data:r.data,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:o});case 6:return a=n.sent,(c=Object.assign({},a)).expires_in&&(c.expires_at=C(a.expires_in)),n.abrupt("return",{data:c,error:null});case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 15:case"end":return n.stop()}}),i,this,[[0,12]])})))}},{key:"signInWithEmail",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function i(){var o,s,a,c;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=Object.assign({},this.headers),s="?grant_type=password",r.redirectTo&&(s+="&redirect_to="+encodeURIComponent(r.redirectTo)),n.next=6,E(this.fetch,"".concat(this.url,"/token").concat(s),{email:e,password:t,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:o});case 6:return a=n.sent,(c=Object.assign({},a)).expires_in&&(c.expires_at=C(a.expires_in)),n.abrupt("return",{data:c,error:null});case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 15:case"end":return n.stop()}}),i,this,[[0,12]])})))}},{key:"signUpWithPhone",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function i(){var o,s,a;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=Object.assign({},this.headers),n.next=4,E(this.fetch,"".concat(this.url,"/signup"),{phone:e,password:t,data:r.data,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:o});case 4:return s=n.sent,(a=Object.assign({},s)).expires_in&&(a.expires_at=C(s.expires_in)),n.abrupt("return",{data:a,error:null});case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 13:case"end":return n.stop()}}),i,this,[[0,10]])})))}},{key:"signInWithPhone",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function i(){var o,s,a;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=Object.assign({},this.headers),"?grant_type=password",n.next=5,E(this.fetch,"".concat(this.url,"/token").concat("?grant_type=password"),{phone:e,password:t,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:o});case 5:return s=n.sent,(a=Object.assign({},s)).expires_in&&(a.expires_at=C(s.expires_in)),n.abrupt("return",{data:a,error:null});case 11:return n.prev=11,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 14:case"end":return n.stop()}}),i,this,[[0,11]])})))}},{key:"signInWithOpenIDConnect",value:function(e){var t=e.id_token,r=e.nonce,i=e.client_id,o=e.issuer,s=e.provider;return G(this,void 0,void 0,(0,n.Z)().mark((function e(){var a,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object.assign({},this.headers),"?grant_type=id_token",e.next=5,E(this.fetch,"".concat(this.url,"/token").concat("?grant_type=id_token"),{id_token:t,nonce:r,client_id:i,issuer:o,provider:s},{headers:a});case 5:return c=e.sent,(u=Object.assign({},c)).expires_in&&(u.expires_at=C(c.expires_in)),e.abrupt("return",{data:u,error:null});case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",{data:null,error:e.t0});case 14:case"end":return e.stop()}}),e,this,[[0,11]])})))}},{key:"sendMagicLinkEmail",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function i(){var o,s,a,c;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=Object.assign({},this.headers),s="",r.redirectTo&&(s+="?redirect_to="+encodeURIComponent(r.redirectTo)),a=null===(t=r.shouldCreateUser)||void 0===t||t,n.next=7,E(this.fetch,"".concat(this.url,"/otp").concat(s),{email:e,create_user:a,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:o});case 7:return c=n.sent,n.abrupt("return",{data:c,error:null});case 11:return n.prev=11,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 14:case"end":return n.stop()}}),i,this,[[0,11]])})))}},{key:"sendMobileOTP",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function i(){var o,s,a;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=null===(t=r.shouldCreateUser)||void 0===t||t,s=Object.assign({},this.headers),n.next=5,E(this.fetch,"".concat(this.url,"/otp"),{phone:e,create_user:o,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:s});case 5:return a=n.sent,n.abrupt("return",{data:a,error:null});case 9:return n.prev=9,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 12:case"end":return n.stop()}}),i,this,[[0,9]])})))}},{key:"signOut",value:function(e){return G(this,void 0,void 0,(0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E(this.fetch,"".concat(this.url,"/logout"),{},{headers:this._createRequestHeaders(e),noResolveJson:!0});case 3:return t.abrupt("return",{error:null});case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",{error:t.t0});case 9:case"end":return t.stop()}}),t,this,[[0,6]])})))}},{key:"verifyMobileOTP",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function i(){var o,s,a;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=Object.assign({},this.headers),n.next=4,E(this.fetch,"".concat(this.url,"/verify"),{phone:e,token:t,type:"sms",redirect_to:r.redirectTo},{headers:o});case 4:return s=n.sent,(a=Object.assign({},s)).expires_in&&(a.expires_at=C(s.expires_in)),n.abrupt("return",{data:a,error:null});case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 13:case"end":return n.stop()}}),i,this,[[0,10]])})))}},{key:"verifyOTP",value:function(e){var t=e.email,r=e.phone,i=e.token,o=e.type,s=void 0===o?"sms":o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function e(){var o,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=Object.assign({},this.headers),e.next=4,E(this.fetch,"".concat(this.url,"/verify"),{email:t,phone:r,token:i,type:s,redirect_to:a.redirectTo},{headers:o});case 4:return c=e.sent,(u=Object.assign({},c)).expires_in&&(u.expires_at=C(c.expires_in)),e.abrupt("return",{data:u,error:null});case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",{data:null,error:e.t0});case 13:case"end":return e.stop()}}),e,this,[[0,10]])})))}},{key:"inviteUserByEmail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function r(){var i,o,s;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,i=Object.assign({},this.headers),o="",t.redirectTo&&(o+="?redirect_to="+encodeURIComponent(t.redirectTo)),r.next=6,E(this.fetch,"".concat(this.url,"/invite").concat(o),{email:e,data:t.data},{headers:i});case 6:return s=r.sent,r.abrupt("return",{data:s,error:null});case 10:return r.prev=10,r.t0=r.catch(0),r.abrupt("return",{data:null,error:r.t0});case 13:case"end":return r.stop()}}),r,this,[[0,10]])})))}},{key:"resetPasswordForEmail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function r(){var i,o,s;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,i=Object.assign({},this.headers),o="",t.redirectTo&&(o+="?redirect_to="+encodeURIComponent(t.redirectTo)),r.next=6,E(this.fetch,"".concat(this.url,"/recover").concat(o),{email:e,gotrue_meta_security:{captcha_token:t.captchaToken}},{headers:i});case 6:return s=r.sent,r.abrupt("return",{data:s,error:null});case 10:return r.prev=10,r.t0=r.catch(0),r.abrupt("return",{data:null,error:r.t0});case 13:case"end":return r.stop()}}),r,this,[[0,10]])})))}},{key:"refreshAccessToken",value:function(e){return G(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,i;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E(this.fetch,"".concat(this.url,"/token?grant_type=refresh_token"),{refresh_token:e},{headers:this.headers});case 3:return r=t.sent,(i=Object.assign({},r)).expires_in&&(i.expires_at=C(r.expires_in)),t.abrupt("return",{data:i,error:null});case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",{data:null,error:t.t0});case 12:case"end":return t.stop()}}),t,this,[[0,9]])})))}},{key:"setAuthCookie",value:function(e,t){var r=this;"POST"!==e.method&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));var n=e.body,i=n.event,o=n.session;if(!i)throw new Error("Auth event missing!");if("SIGNED_IN"===i){if(!o)throw new Error("Auth session missing!");R(e,t,[{key:"access-token",value:o.access_token},{key:"refresh-token",value:o.refresh_token}].map((function(e){var t;return{name:"".concat(r.cookieName(),"-").concat(e.key),value:e.value,domain:r.cookieOptions.domain,maxAge:null!==(t=r.cookieOptions.lifetime)&&void 0!==t?t:0,path:r.cookieOptions.path,sameSite:r.cookieOptions.sameSite}})))}"SIGNED_OUT"===i&&R(e,t,["access-token","refresh-token"].map((function(e){return{name:"".concat(r.cookieName(),"-").concat(e),value:"",maxAge:-1}}))),t.status(200).json({})}},{key:"deleteAuthCookie",value:function(e,t,r){var n=this,i=r.redirectTo,o=void 0===i?"/":i;return R(e,t,["access-token","refresh-token"].map((function(e){return{name:"".concat(n.cookieName(),"-").concat(e),value:"",maxAge:-1}}))),t.redirect(307,o)}},{key:"getAuthCookieString",value:function(e,t){var r=this;"POST"!==e.method&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));var n=e.body,i=n.event,o=n.session;if(!i)throw new Error("Auth event missing!");if("SIGNED_IN"===i){if(!o)throw new Error("Auth session missing!");return Z(e,t,[{key:"access-token",value:o.access_token},{key:"refresh-token",value:o.refresh_token}].map((function(e){var t;return{name:"".concat(r.cookieName(),"-").concat(e.key),value:e.value,domain:r.cookieOptions.domain,maxAge:null!==(t=r.cookieOptions.lifetime)&&void 0!==t?t:0,path:r.cookieOptions.path,sameSite:r.cookieOptions.sameSite}})))}return"SIGNED_OUT"===i?Z(e,t,["access-token","refresh-token"].map((function(e){return{name:"".concat(r.cookieName(),"-").concat(e),value:"",maxAge:-1}}))):t.getHeader("Set-Cookie")}},{key:"generateLink",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return G(this,void 0,void 0,(0,n.Z)().mark((function i(){var o;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,E(this.fetch,"".concat(this.url,"/admin/generate_link"),{type:e,email:t,password:r.password,data:r.data,redirect_to:r.redirectTo},{headers:this.headers});case 3:return o=n.sent,n.abrupt("return",{data:o,error:null});case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 10:case"end":return n.stop()}}),i,this,[[0,7]])})))}},{key:"createUser",value:function(e){return G(this,void 0,void 0,(0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E(this.fetch,"".concat(this.url,"/admin/users"),e,{headers:this.headers});case 3:return r=t.sent,t.abrupt("return",{user:r,data:r,error:null});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{user:null,data:null,error:t.t0});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"listUsers",value:function(){return G(this,void 0,void 0,(0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S(this.fetch,"".concat(this.url,"/admin/users"),{headers:this.headers});case 3:return t=e.sent,e.abrupt("return",{data:t.users,error:null});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{data:null,error:e.t0});case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"getUserById",value:function(e){return G(this,void 0,void 0,(0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S(this.fetch,"".concat(this.url,"/admin/users/").concat(e),{headers:this.headers});case 3:return r=t.sent,t.abrupt("return",{data:r,error:null});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{data:null,error:t.t0});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"getUserByCookie",value:function(e,t){return G(this,void 0,void 0,(0,n.Z)().mark((function r(){var i,o,s,a,c,u,h,l=this;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,e.cookies){r.next=3;break}throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");case 3:if(i=e.cookies["".concat(this.cookieName(),"-access-token")],o=e.cookies["".concat(this.cookieName(),"-refresh-token")],i){r.next=7;break}throw new Error("No cookie found!");case 7:return r.next=9,this.getUser(i);case 9:if(s=r.sent,a=s.user,!s.error){r.next=29;break}if(o){r.next=15;break}throw new Error("No refresh_token cookie found!");case 15:if(t){r.next=17;break}throw new Error("You need to pass the res object to automatically refresh the session!");case 17:return r.next=19,this.refreshAccessToken(o);case 19:if(c=r.sent,u=c.data,!(h=c.error)){r.next=26;break}throw h;case 26:if(!u){r.next=29;break}return R(e,t,[{key:"access-token",value:u.access_token},{key:"refresh-token",value:u.refresh_token}].map((function(e){var t;return{name:"".concat(l.cookieName(),"-").concat(e.key),value:e.value,domain:l.cookieOptions.domain,maxAge:null!==(t=l.cookieOptions.lifetime)&&void 0!==t?t:0,path:l.cookieOptions.path,sameSite:l.cookieOptions.sameSite}}))),r.abrupt("return",{token:u.access_token,user:u.user,data:u.user,error:null});case 29:return r.abrupt("return",{token:i,user:a,data:a,error:null});case 32:return r.prev=32,r.t0=r.catch(0),r.abrupt("return",{token:null,user:null,data:null,error:r.t0});case 35:case"end":return r.stop()}}),r,this,[[0,32]])})))}},{key:"updateUserById",value:function(e,t){return G(this,void 0,void 0,(0,n.Z)().mark((function r(){var i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=4,O(this.fetch,"".concat(this.url,"/admin/users/").concat(e),t,{headers:this.headers});case 4:return i=r.sent,r.abrupt("return",{user:i,data:i,error:null});case 8:return r.prev=8,r.t0=r.catch(0),r.abrupt("return",{user:null,data:null,error:r.t0});case 11:case"end":return r.stop()}}),r,this,[[0,8]])})))}},{key:"deleteUser",value:function(e){return G(this,void 0,void 0,(0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j(this.fetch,"".concat(this.url,"/admin/users/").concat(e),{},{headers:this.headers});case 3:return r=t.sent,t.abrupt("return",{user:r,data:r,error:null});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{user:null,data:null,error:t.t0});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"getUser",value:function(e){return G(this,void 0,void 0,(0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S(this.fetch,"".concat(this.url,"/user"),{headers:this._createRequestHeaders(e)});case 3:return r=t.sent,t.abrupt("return",{user:r,data:r,error:null});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{user:null,data:null,error:t.t0});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"updateUser",value:function(e,t){return G(this,void 0,void 0,(0,n.Z)().mark((function r(){var i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,O(this.fetch,"".concat(this.url,"/user"),t,{headers:this._createRequestHeaders(e)});case 3:return i=r.sent,r.abrupt("return",{user:i,data:i,error:null});case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",{user:null,data:null,error:r.t0});case 10:case"end":return r.stop()}}),r,this,[[0,7]])})))}}]),e}();var B=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();var F={url:"http://localhost:9999",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:p},H=function(e){try{return atob(e.replace(/[-]/g,"+").replace(/[_]/g,"/"))}catch(t){if(t instanceof ReferenceError)return Buffer.from(e,"base64").toString("utf-8");throw t}},J=function(){function e(t){i(this,e),this.stateChangeEmitters=new Map,this.networkRetries=0;var r=Object.assign(Object.assign({},F),t);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=r.autoRefreshToken,this.persistSession=r.persistSession,this.multiTab=r.multiTab,this.localStorage=r.localStorage||globalThis.localStorage,this.api=new M({url:r.url,headers:r.headers,cookieOptions:r.cookieOptions,fetch:r.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),this._handleVisibilityChange(),r.detectSessionInUrl&&I()&&U("access_token")&&this.getSessionFromUrl({storeSession:!0}).then((function(e){if(e.error)throw new Error("Error getting session from URL.")}))}return s(e,[{key:"signUp",value:function(e){var t=e.email,r=e.password,i=e.phone,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return B(this,void 0,void 0,(0,n.Z)().mark((function e(){var s,a,c,u,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this._removeSession(),!i||!r){e.next=8;break}return e.next=5,this.api.signUpWithPhone(i,r,{data:o.data,captchaToken:o.captchaToken});case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,this.api.signUpWithEmail(t,r,{redirectTo:o.redirectTo,data:o.data,captchaToken:o.captchaToken});case 10:e.t0=e.sent;case 11:if(s=e.t0,a=s.data,!(c=s.error)){e.next=16;break}throw c;case 16:if(a){e.next=18;break}throw"An error occurred on sign up.";case 18:return u=null,h=null,a.access_token&&(h=(u=a).user,this._saveSession(u),this._notifyAllSubscribers("SIGNED_IN")),a.id&&(h=a),e.abrupt("return",{user:h,session:u,error:null});case 25:return e.prev=25,e.t1=e.catch(0),e.abrupt("return",{user:null,session:null,error:e.t1});case 28:case"end":return e.stop()}}),e,this,[[0,25]])})))}},{key:"signIn",value:function(e){var t=e.email,r=e.phone,i=e.password,o=e.refreshToken,s=e.provider,a=e.oidc,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return B(this,void 0,void 0,(0,n.Z)().mark((function e(){var u,h,l,f,d,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this._removeSession(),!t||i){e.next=8;break}return e.next=5,this.api.sendMagicLinkEmail(t,{redirectTo:c.redirectTo,shouldCreateUser:c.shouldCreateUser,captchaToken:c.captchaToken});case 5:return u=e.sent,h=u.error,e.abrupt("return",{user:null,session:null,error:h});case 8:if(!t||!i){e.next=10;break}return e.abrupt("return",this._handleEmailSignIn(t,i,{redirectTo:c.redirectTo,captchaToken:c.captchaToken}));case 10:if(!r||i){e.next=16;break}return e.next=13,this.api.sendMobileOTP(r,{shouldCreateUser:c.shouldCreateUser,captchaToken:c.captchaToken});case 13:return l=e.sent,f=l.error,e.abrupt("return",{user:null,session:null,error:f});case 16:if(!r||!i){e.next=18;break}return e.abrupt("return",this._handlePhoneSignIn(r,i));case 18:if(!o){e.next=26;break}return e.next=21,this._callRefreshToken(o);case 21:if(d=e.sent,!(p=d.error)){e.next=25;break}throw p;case 25:return e.abrupt("return",{user:this.currentUser,session:this.currentSession,error:null});case 26:if(!s){e.next=28;break}return e.abrupt("return",this._handleProviderSignIn(s,{redirectTo:c.redirectTo,scopes:c.scopes,queryParams:c.queryParams}));case 28:if(!a){e.next=30;break}return e.abrupt("return",this._handleOpenIDConnectSignIn(a));case 30:throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.");case 33:return e.prev=33,e.t0=e.catch(0),e.abrupt("return",{user:null,session:null,error:e.t0});case 36:case"end":return e.stop()}}),e,this,[[0,33]])})))}},{key:"verifyOTP",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return B(this,void 0,void 0,(0,n.Z)().mark((function r(){var i,o,s,a,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,this._removeSession(),r.next=4,this.api.verifyOTP(e,t);case 4:if(i=r.sent,o=i.data,!(s=i.error)){r.next=9;break}throw s;case 9:if(o){r.next=11;break}throw"An error occurred on token verification.";case 11:return a=null,c=null,o.access_token&&(c=(a=o).user,this._saveSession(a),this._notifyAllSubscribers("SIGNED_IN")),o.id&&(c=o),r.abrupt("return",{user:c,session:a,error:null});case 18:return r.prev=18,r.t0=r.catch(0),r.abrupt("return",{user:null,session:null,error:r.t0});case 21:case"end":return r.stop()}}),r,this,[[0,18]])})))}},{key:"user",value:function(){return this.currentUser}},{key:"session",value:function(){return this.currentSession}},{key:"refreshSession",value:function(){var e;return B(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,i;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,null===(e=this.currentSession)||void 0===e?void 0:e.access_token){t.next=3;break}throw new Error("Not logged in.");case 3:return t.next=5,this._callRefreshToken();case 5:if(r=t.sent,!(i=r.error)){t.next=9;break}throw i;case 9:return t.abrupt("return",{data:this.currentSession,user:this.currentUser,error:null});case 12:return t.prev=12,t.t0=t.catch(0),t.abrupt("return",{data:null,user:null,error:t.t0});case 15:case"end":return t.stop()}}),t,this,[[0,12]])})))}},{key:"update",value:function(e){var t;return B(this,void 0,void 0,(0,n.Z)().mark((function r(){var i,o,s,a;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,null===(t=this.currentSession)||void 0===t?void 0:t.access_token){r.next=3;break}throw new Error("Not logged in.");case 3:return r.next=5,this.api.updateUser(this.currentSession.access_token,e);case 5:if(i=r.sent,o=i.user,!(s=i.error)){r.next=10;break}throw s;case 10:if(o){r.next=12;break}throw Error("Invalid user data.");case 12:return a=Object.assign(Object.assign({},this.currentSession),{user:o}),this._saveSession(a),this._notifyAllSubscribers("USER_UPDATED"),r.abrupt("return",{data:o,user:o,error:null});case 18:return r.prev=18,r.t0=r.catch(0),r.abrupt("return",{data:null,user:null,error:r.t0});case 21:case"end":return r.stop()}}),r,this,[[0,18]])})))}},{key:"setSession",value:function(e){return B(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,i,o,s,a,c,u,h,l,f,d,p,v,m,y,b,k,g,w;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof e){t.next=12;break}return i=e,t.next=4,this.api.refreshAccessToken(i);case 4:if(o=t.sent,s=o.data,!(a=o.error)){t.next=9;break}return t.abrupt("return",{session:null,error:a});case 9:r=s,t.next=53;break;case 12:if(c=Math.round(Date.now()/1e3),u=e.refresh_token,h=e.access_token,l=0,f=0,3===(d=h.split(".")).length){t.next=19;break}throw new Error("access_token is not a proper JWT");case 19:p=H(d[1]),v=void 0,t.prev=21,v=JSON.parse(p),t.next=28;break;case 25:throw t.prev=25,t.t0=t.catch(21),new Error("access_token is not a proper JWT, invalid JSON in body");case 28:if("object"!==typeof v||!v||"number"!==typeof v.exp){t.next=33;break}l=v.exp,f=c-v.exp,t.next=34;break;case 33:throw new Error("access_token is not a proper JWT, missing exp claim");case 34:if(!(c>l)){t.next=45;break}return t.next=37,this.api.refreshAccessToken(u);case 37:if(m=t.sent,y=m.data,!(b=m.error)){t.next=42;break}return t.abrupt("return",{session:null,error:b});case 42:r=y,t.next=53;break;case 45:return t.next=47,this.api.getUser(h);case 47:if(k=t.sent,g=k.user,!(w=k.error)){t.next=52;break}throw w;case 52:r={access_token:h,expires_in:f,expires_at:l,refresh_token:u,token_type:"bearer",user:g};case 53:return t.prev=53,this._saveSession(r),this._notifyAllSubscribers("SIGNED_IN"),t.abrupt("return",{session:r,error:null});case 59:return t.prev=59,t.t1=t.catch(53),t.abrupt("return",{error:t.t1,session:null});case 62:case"end":return t.stop()}}),t,this,[[21,25],[53,59]])})))}},{key:"setAuth",value:function(e){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:e,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}},{key:"getSessionFromUrl",value:function(e){return B(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,i,o,s,a,c,u,h,l,f,d,p,v,m;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,I()){t.next=3;break}throw new Error("No browser detected.");case 3:if(!(r=U("error_description"))){t.next=6;break}throw new Error(r);case 6:if(i=U("provider_token"),o=U("provider_refresh_token"),s=U("access_token")){t.next=11;break}throw new Error("No access_token detected.");case 11:if(a=U("expires_in")){t.next=14;break}throw new Error("No expires_in detected.");case 14:if(c=U("refresh_token")){t.next=17;break}throw new Error("No refresh_token detected.");case 17:if(u=U("token_type")){t.next=20;break}throw new Error("No token_type detected.");case 20:return h=Math.round(Date.now()/1e3),l=h+parseInt(a),t.next=24,this.api.getUser(s);case 24:if(f=t.sent,d=f.user,!(p=f.error)){t.next=29;break}throw p;case 29:return v={provider_token:i,provider_refresh_token:o,access_token:s,expires_in:parseInt(a),expires_at:l,refresh_token:c,token_type:u,user:d},(null===e||void 0===e?void 0:e.storeSession)&&(this._saveSession(v),m=U("type"),this._notifyAllSubscribers("SIGNED_IN"),"recovery"===m&&this._notifyAllSubscribers("PASSWORD_RECOVERY")),window.location.hash="",t.abrupt("return",{data:v,error:null});case 35:return t.prev=35,t.t0=t.catch(0),t.abrupt("return",{data:null,error:t.t0});case 38:case"end":return t.stop()}}),t,this,[[0,35]])})))}},{key:"signOut",value:function(){var e;return B(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,i,o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null===(e=this.currentSession)||void 0===e?void 0:e.access_token,this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),!r){t.next=10;break}return t.next=6,this.api.signOut(r);case 6:if(i=t.sent,!(o=i.error)){t.next=10;break}return t.abrupt("return",{error:o});case 10:return t.abrupt("return",{error:null});case 11:case"end":return t.stop()}}),t,this)})))}},{key:"onAuthStateChange",value:function(e){var t=this;try{var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),n={id:r,callback:e,unsubscribe:function(){t.stateChangeEmitters.delete(r)}};return this.stateChangeEmitters.set(r,n),{data:n,error:null}}catch(i){return{data:null,error:i}}}},{key:"_handleEmailSignIn",value:function(e,t){var r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return B(this,void 0,void 0,(0,n.Z)().mark((function s(){var a,c,u;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.api.signInWithEmail(e,t,{redirectTo:o.redirectTo,captchaToken:o.captchaToken});case 3:if(a=n.sent,c=a.data,!(u=a.error)&&c){n.next=8;break}return n.abrupt("return",{data:null,user:null,session:null,error:u});case 8:return((null===(r=null===c||void 0===c?void 0:c.user)||void 0===r?void 0:r.confirmed_at)||(null===(i=null===c||void 0===c?void 0:c.user)||void 0===i?void 0:i.email_confirmed_at))&&(this._saveSession(c),this._notifyAllSubscribers("SIGNED_IN")),n.abrupt("return",{data:c,user:c.user,session:c,error:null});case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",{data:null,user:null,session:null,error:n.t0});case 15:case"end":return n.stop()}}),s,this,[[0,12]])})))}},{key:"_handlePhoneSignIn",value:function(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return B(this,void 0,void 0,(0,n.Z)().mark((function o(){var s,a,c;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.api.signInWithPhone(e,t,i);case 3:if(s=n.sent,a=s.data,!(c=s.error)&&a){n.next=8;break}return n.abrupt("return",{data:null,user:null,session:null,error:c});case 8:return(null===(r=null===a||void 0===a?void 0:a.user)||void 0===r?void 0:r.phone_confirmed_at)&&(this._saveSession(a),this._notifyAllSubscribers("SIGNED_IN")),n.abrupt("return",{data:a,user:a.user,session:a,error:null});case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",{data:null,user:null,session:null,error:n.t0});case 15:case"end":return n.stop()}}),o,this,[[0,12]])})))}},{key:"_handleProviderSignIn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.api.getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});try{return I()&&(window.location.href=r),{provider:e,url:r,data:null,session:null,user:null,error:null}}catch(n){return r?{provider:e,url:r,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:n}}}},{key:"_handleOpenIDConnectSignIn",value:function(e){var t=e.id_token,r=e.nonce,i=e.client_id,o=e.issuer,s=e.provider;return B(this,void 0,void 0,(0,n.Z)().mark((function e(){var a,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&r&&(i&&o||s))){e.next=17;break}return e.prev=1,e.next=4,this.api.signInWithOpenIDConnect({id_token:t,nonce:r,client_id:i,issuer:o,provider:s});case 4:if(a=e.sent,c=a.data,!(u=a.error)&&c){e.next=9;break}return e.abrupt("return",{user:null,session:null,error:u});case 9:return this._saveSession(c),this._notifyAllSubscribers("SIGNED_IN"),e.abrupt("return",{user:c.user,session:c,error:null});case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt("return",{user:null,session:null,error:e.t0});case 17:throw new Error("You must provide a OpenID Connect provider with your id token and nonce.");case 18:case"end":return e.stop()}}),e,this,[[1,14]])})))}},{key:"_recoverSession",value:function(){try{var e=function(e,t){var r=I()&&(null===e||void 0===e?void 0:e.getItem(t));if(!r||"string"!==typeof r)return null;try{return JSON.parse(r)}catch(n){return r}}(this.localStorage,b);if(!e)return null;var t=e.currentSession;e.expiresAt>=Math.round(Date.now()/1e3)+10&&(null===t||void 0===t?void 0:t.user)&&(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"))}catch(r){console.log("error",r)}}},{key:"_recoverAndRefresh",value:function(){return B(this,void 0,void 0,(0,n.Z)().mark((function e(){var t,r,i,o,s,a,c=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L(this.localStorage,b);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:if(r=t.currentSession,i=t.expiresAt,o=Math.round(Date.now()/1e3),!(i<o+10)){e.next=29;break}if(!this.autoRefreshToken||!r.refresh_token){e.next=26;break}return this.networkRetries++,e.next=13,this._callRefreshToken(r.refresh_token);case 13:if(s=e.sent,!(a=s.error)){e.next=23;break}if(console.log(a.message),!(a.message===v&&this.networkRetries<m)){e.next=21;break}return this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),this.refreshTokenTimer=setTimeout((function(){return c._recoverAndRefresh()}),100*Math.pow(y,this.networkRetries)),e.abrupt("return");case 21:return e.next=23,this._removeSession();case 23:this.networkRetries=0,e.next=27;break;case 26:this._removeSession();case 27:e.next=30;break;case 29:r?(this._saveSession(r),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession());case 30:e.next=36;break;case 32:return e.prev=32,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 36:case"end":return e.stop()}}),e,this,[[0,32]])})))}},{key:"_callRefreshToken",value:function(e){var t;return void 0===e&&(e=null===(t=this.currentSession)||void 0===t?void 0:t.refresh_token),B(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,i,o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("No current session.");case 3:return t.next=5,this.api.refreshAccessToken(e);case 5:if(r=t.sent,i=r.data,!(o=r.error)){t.next=10;break}throw o;case 10:if(i){t.next=12;break}throw Error("Invalid session data.");case 12:return this._saveSession(i),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),t.abrupt("return",{data:i,error:null});case 18:return t.prev=18,t.t0=t.catch(0),t.abrupt("return",{data:null,error:t.t0});case 21:case"end":return t.stop()}}),t,this,[[0,18]])})))}},{key:"_notifyAllSubscribers",value:function(e){var t=this;this.stateChangeEmitters.forEach((function(r){return r.callback(e,t.currentSession)}))}},{key:"_saveSession",value:function(e){this.currentSession=e,this.currentUser=e.user;var t=e.expires_at;if(t){var r=t-Math.round(Date.now()/1e3),n=r>10?10:.5;this._startAutoRefreshToken(1e3*(r-n))}this.persistSession&&e.expires_at&&this._persistSession(this.currentSession)}},{key:"_persistSession",value:function(e){var t={currentSession:e,expiresAt:e.expires_at};!function(e,t,r){A(void 0,void 0,void 0,(0,n.Z)().mark((function i(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=I(),!n.t0){n.next=4;break}return n.next=4,null===e||void 0===e?void 0:e.setItem(t,JSON.stringify(r));case 4:case"end":return n.stop()}}),i)})))}(this.localStorage,b,t)}},{key:"_removeSession",value:function(){return B(this,void 0,void 0,(0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),D(this.localStorage,b);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"_startAutoRefreshToken",value:function(e){var t=this;this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),e<=0||!this.autoRefreshToken||(this.refreshTokenTimer=setTimeout((function(){return B(t,void 0,void 0,(0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.networkRetries++,e.next=3,this._callRefreshToken();case 3:t=e.sent,(r=t.error)||(this.networkRetries=0),(null===r||void 0===r?void 0:r.message)===v&&this.networkRetries<m&&this._startAutoRefreshToken(100*Math.pow(y,this.networkRetries));case 7:case"end":return e.stop()}}),e,this)})))}),e),"function"===typeof this.refreshTokenTimer.unref&&this.refreshTokenTimer.unref())}},{key:"_listenForMultiTabEvents",value:function(){var e=this;if(!this.multiTab||!I()||!(null===window||void 0===window?void 0:window.addEventListener))return!1;try{null===window||void 0===window||window.addEventListener("storage",(function(t){var r;if(t.key===b){var n=JSON.parse(String(t.newValue));(null===(r=null===n||void 0===n?void 0:n.currentSession)||void 0===r?void 0:r.access_token)?(e._saveSession(n.currentSession),e._notifyAllSubscribers("SIGNED_IN")):(e._removeSession(),e._notifyAllSubscribers("SIGNED_OUT"))}}))}catch(t){console.error("_listenForMultiTabEvents",t)}}},{key:"_handleVisibilityChange",value:function(){var e=this;if(!this.multiTab||!I()||!(null===window||void 0===window?void 0:window.addEventListener))return!1;try{null===window||void 0===window||window.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&e._recoverAndRefresh()}))}catch(t){console.error("_handleVisibilityChange",t)}}}]),e}(),z=function(e){u(r,e);var t=d(r);function r(e){return i(this,r),t.call(this,e)}return s(r)}(J),q=r(907);var K=r(181);function W(e){return function(e){if(Array.isArray(e))return(0,q.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,K.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var V,Y=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},$=function(){function e(t){var o,s=this;i(this,e),Object.assign(this,t),o=t.fetch?t.fetch:"undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return Y(s,void 0,void 0,(0,n.Z)().mark((function e(){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(255).then(r.t.bind(r,255,23));case 2:return e.next=4,(i=e.sent).fetch.apply(i,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))}:fetch,this.fetch=function(){return o.apply(void 0,arguments)},this.shouldThrowOnError=t.shouldThrowOnError||!1,this.allowEmpty=t.allowEmpty||!1}return s(e,[{key:"throwOnError",value:function(e){return null!==e&&void 0!==e||(e=!0),this.shouldThrowOnError=e,this}},{key:"then",value:function(e,t){var r=this;"undefined"===typeof this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");var i=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((function(e){return Y(r,void 0,void 0,(0,n.Z)().mark((function t(){var r,i,o,s,a,c,u,h,l,f,d,p,v,m,y;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=null,c=null,u=null,h=e.status,l=e.statusText,!e.ok){t.next=17;break}if(f=null===(r=this.headers.Prefer)||void 0===r?void 0:r.split(",").includes("return=minimal"),"HEAD"===this.method||f){t.next=12;break}return t.next=10,e.text();case 10:(d=t.sent)&&(c="text/csv"===this.headers.Accept?d:JSON.parse(d));case 12:p=null===(i=this.headers.Prefer)||void 0===i?void 0:i.match(/count=(exact|planned|estimated)/),v=null===(o=e.headers.get("content-range"))||void 0===o?void 0:o.split("/"),p&&v&&v.length>1&&(u=parseInt(v[1])),t.next=24;break;case 17:return t.next=19,e.text();case 19:m=t.sent;try{a=JSON.parse(m)}catch(n){a={message:m}}if(a&&this.allowEmpty&&(null===(s=null===a||void 0===a?void 0:a.details)||void 0===s?void 0:s.includes("Results contain 0 rows"))&&(a=null,h=200,l="OK"),!a||!this.shouldThrowOnError){t.next=24;break}throw a;case 24:return y={error:a,data:c,count:u,status:h,statusText:l,body:c},t.abrupt("return",y);case 26:case"end":return t.stop()}}),t,this)})))}));return this.shouldThrowOnError||(i=i.catch((function(e){return{error:{message:"FetchError: ".concat(e.message),details:"",hint:"",code:e.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}}))),i.then(e,t)}}]),e}(),X=function(e){u(r,e);var t=d(r);function r(){return i(this,r),t.apply(this,arguments)}return s(r,[{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",t=!1,r=e.split("").map((function(e){return/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)})).join("");return this.url.searchParams.set("select",r),this}},{key:"order",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.ascending,n=void 0===r||r,i=t.nullsFirst,o=void 0!==i&&i,s=t.foreignTable,a="undefined"===typeof s?"order":"".concat(s,".order"),c=this.url.searchParams.get(a);return this.url.searchParams.set(a,"".concat(c?"".concat(c,","):"").concat(e,".").concat(n?"asc":"desc",".").concat(o?"nullsfirst":"nullslast")),this}},{key:"limit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.foreignTable,n="undefined"===typeof r?"limit":"".concat(r,".limit");return this.url.searchParams.set(n,"".concat(e)),this}},{key:"range",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.foreignTable,i="undefined"===typeof n?"offset":"".concat(n,".offset"),o="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(i,"".concat(e)),this.url.searchParams.set(o,"".concat(t-e+1)),this}},{key:"abortSignal",value:function(e){return this.signal=e,this}},{key:"single",value:function(){return this.headers.Accept="application/vnd.pgrst.object+json",this}},{key:"maybeSingle",value:function(){return this.headers.Accept="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}},{key:"csv",value:function(){return this.headers.Accept="text/csv",this}}]),r}($),Q=function(e){u(r,e);var t=d(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).cs=e.contains,e.cd=e.containedBy,e.sl=e.rangeLt,e.sr=e.rangeGt,e.nxl=e.rangeGte,e.nxr=e.rangeLte,e.adj=e.rangeAdjacent,e.ov=e.overlaps,e}return s(r,[{key:"not",value:function(e,t,r){return this.url.searchParams.append("".concat(e),"not.".concat(t,".").concat(r)),this}},{key:"or",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.foreignTable,n="undefined"===typeof r?"or":"".concat(r,".or");return this.url.searchParams.append(n,"(".concat(e,")")),this}},{key:"eq",value:function(e,t){return this.url.searchParams.append("".concat(e),"eq.".concat(t)),this}},{key:"neq",value:function(e,t){return this.url.searchParams.append("".concat(e),"neq.".concat(t)),this}},{key:"gt",value:function(e,t){return this.url.searchParams.append("".concat(e),"gt.".concat(t)),this}},{key:"gte",value:function(e,t){return this.url.searchParams.append("".concat(e),"gte.".concat(t)),this}},{key:"lt",value:function(e,t){return this.url.searchParams.append("".concat(e),"lt.".concat(t)),this}},{key:"lte",value:function(e,t){return this.url.searchParams.append("".concat(e),"lte.".concat(t)),this}},{key:"like",value:function(e,t){return this.url.searchParams.append("".concat(e),"like.".concat(t)),this}},{key:"ilike",value:function(e,t){return this.url.searchParams.append("".concat(e),"ilike.".concat(t)),this}},{key:"is",value:function(e,t){return this.url.searchParams.append("".concat(e),"is.".concat(t)),this}},{key:"in",value:function(e,t){var r=t.map((function(e){return"string"===typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e)})).join(",");return this.url.searchParams.append("".concat(e),"in.(".concat(r,")")),this}},{key:"contains",value:function(e,t){return"string"===typeof t?this.url.searchParams.append("".concat(e),"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append("".concat(e),"cs.{".concat(t.join(","),"}")):this.url.searchParams.append("".concat(e),"cs.".concat(JSON.stringify(t))),this}},{key:"containedBy",value:function(e,t){return"string"===typeof t?this.url.searchParams.append("".concat(e),"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append("".concat(e),"cd.{".concat(t.join(","),"}")):this.url.searchParams.append("".concat(e),"cd.".concat(JSON.stringify(t))),this}},{key:"rangeLt",value:function(e,t){return this.url.searchParams.append("".concat(e),"sl.".concat(t)),this}},{key:"rangeGt",value:function(e,t){return this.url.searchParams.append("".concat(e),"sr.".concat(t)),this}},{key:"rangeGte",value:function(e,t){return this.url.searchParams.append("".concat(e),"nxl.".concat(t)),this}},{key:"rangeLte",value:function(e,t){return this.url.searchParams.append("".concat(e),"nxr.".concat(t)),this}},{key:"rangeAdjacent",value:function(e,t){return this.url.searchParams.append("".concat(e),"adj.".concat(t)),this}},{key:"overlaps",value:function(e,t){return"string"===typeof t?this.url.searchParams.append("".concat(e),"ov.".concat(t)):this.url.searchParams.append("".concat(e),"ov.{".concat(t.join(","),"}")),this}},{key:"textSearch",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.config,i=r.type,o=void 0===i?null:i,s="";"plain"===o?s="pl":"phrase"===o?s="ph":"websearch"===o&&(s="w");var a=void 0===n?"":"(".concat(n,")");return this.url.searchParams.append("".concat(e),"".concat(s,"fts").concat(a,".").concat(t)),this}},{key:"fts",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.config,i="undefined"===typeof n?"":"(".concat(n,")");return this.url.searchParams.append("".concat(e),"fts".concat(i,".").concat(t)),this}},{key:"plfts",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.config,i="undefined"===typeof n?"":"(".concat(n,")");return this.url.searchParams.append("".concat(e),"plfts".concat(i,".").concat(t)),this}},{key:"phfts",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.config,i="undefined"===typeof n?"":"(".concat(n,")");return this.url.searchParams.append("".concat(e),"phfts".concat(i,".").concat(t)),this}},{key:"wfts",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.config,i="undefined"===typeof n?"":"(".concat(n,")");return this.url.searchParams.append("".concat(e),"wfts".concat(i,".").concat(t)),this}},{key:"filter",value:function(e,t,r){return this.url.searchParams.append("".concat(e),"".concat(t,".").concat(r)),this}},{key:"match",value:function(e){var t=this;return Object.keys(e).forEach((function(r){t.url.searchParams.append("".concat(r),"eq.".concat(e[r]))})),this}}]),r}(X),ee=function(e){u(r,e);var t=d(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=o.headers,a=void 0===s?{}:s,c=o.schema,u=o.fetch,h=o.shouldThrowOnError;return i(this,r),(n=t.call(this,{fetch:u,shouldThrowOnError:h})).url=new URL(e),n.headers=Object.assign({},a),n.schema=c,n}return s(r,[{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.head,n=void 0!==r&&r,i=t.count,o=void 0===i?null:i;this.method="GET";var s=!1,a=e.split("").map((function(e){return/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)})).join("");return this.url.searchParams.set("select",a),o&&(this.headers.Prefer="count=".concat(o)),n&&(this.method="HEAD"),new Q(this)}},{key:"insert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.upsert,n=void 0!==r&&r,i=t.onConflict,o=t.returning,s=void 0===o?"representation":o,a=t.count,c=void 0===a?null:a;this.method="POST";var u=["return=".concat(s)];if(n&&u.push("resolution=merge-duplicates"),n&&void 0!==i&&this.url.searchParams.set("on_conflict",i),this.body=e,c&&u.push("count=".concat(c)),this.headers.Prefer&&u.unshift(this.headers.Prefer),this.headers.Prefer=u.join(","),Array.isArray(e)){var h=e.reduce((function(e,t){return e.concat(Object.keys(t))}),[]);if(h.length>0){var l=W(new Set(h)).map((function(e){return'"'.concat(e,'"')}));this.url.searchParams.set("columns",l.join(","))}}return new Q(this)}},{key:"upsert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.onConflict,n=t.returning,i=void 0===n?"representation":n,o=t.count,s=void 0===o?null:o,a=t.ignoreDuplicates,c=void 0!==a&&a;this.method="POST";var u=["resolution=".concat(c?"ignore":"merge","-duplicates"),"return=".concat(i)];return void 0!==r&&this.url.searchParams.set("on_conflict",r),this.body=e,s&&u.push("count=".concat(s)),this.headers.Prefer&&u.unshift(this.headers.Prefer),this.headers.Prefer=u.join(","),new Q(this)}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.returning,n=void 0===r?"representation":r,i=t.count,o=void 0===i?null:i;this.method="PATCH";var s=["return=".concat(n)];return this.body=e,o&&s.push("count=".concat(o)),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Q(this)}},{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.returning,r=void 0===t?"representation":t,n=e.count,i=void 0===n?null:n;this.method="DELETE";var o=["return=".concat(r)];return i&&o.push("count=".concat(i)),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new Q(this)}}]),r}($),te=r(885),re=function(e){u(r,e);var t=d(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=o.headers,a=void 0===s?{}:s,c=o.schema,u=o.fetch,h=o.shouldThrowOnError;return i(this,r),(n=t.call(this,{fetch:u,shouldThrowOnError:h})).url=new URL(e),n.headers=Object.assign({},a),n.schema=c,n}return s(r,[{key:"rpc",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.head,i=void 0!==n&&n,o=r.count,s=void 0===o?null:o;return i?(this.method="HEAD",e&&Object.entries(e).forEach((function(e){var r=(0,te.Z)(e,2),n=r[0],i=r[1];t.url.searchParams.append(n,i)}))):(this.method="POST",this.body=e),s&&(void 0!==this.headers.Prefer?this.headers.Prefer+=",count=".concat(s):this.headers.Prefer="count=".concat(s)),new Q(this)}}]),r}($),ne={"X-Client-Info":"postgrest-js/".concat("0.37.4")},ie=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.headers,o=void 0===n?{}:n,s=r.schema,a=r.fetch,c=r.throwOnError;i(this,e),this.url=t,this.headers=Object.assign(Object.assign({},ne),o),this.schema=s,this.fetch=a,this.shouldThrowOnError=c}return s(e,[{key:"auth",value:function(e){return this.headers.Authorization="Bearer ".concat(e),this}},{key:"from",value:function(e){var t="".concat(this.url,"/").concat(e);return new ee(t,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}},{key:"rpc",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.head,i=void 0!==n&&n,o=r.count,s=void 0===o?null:o,a="".concat(this.url,"/rpc/").concat(e);return new re(a,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(t,{head:i,count:s})}}]),e}();!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(V||(V={}));var oe,se,ae,ce,ue,he=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=null!==(r=n.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce((function(r,n){return r[n]=le(n,e,t,i),r}),{})},le=function(e,t,r,n){var i=t.find((function(t){return t.name===e})),o=null===i||void 0===i?void 0:i.type,s=r[e];return o&&!n.includes(o)?fe(o,s):de(s)},fe=function(e,t){if("_"===e.charAt(0)){var r=e.slice(1,e.length);return ye(t,r)}switch(e){case V.bool:return pe(t);case V.float4:case V.float8:case V.int2:case V.int4:case V.int8:case V.numeric:case V.oid:return ve(t);case V.json:case V.jsonb:return me(t);case V.timestamp:return be(t);case V.abstime:case V.date:case V.daterange:case V.int4range:case V.int8range:case V.money:case V.reltime:case V.text:case V.time:case V.timestamptz:case V.timetz:case V.tsrange:case V.tstzrange:default:return de(t)}},de=function(e){return e},pe=function(e){switch(e){case"t":return!0;case"f":return!1;default:return e}},ve=function(e){if("string"===typeof e){var t=parseFloat(e);if(!Number.isNaN(t))return t}return e},me=function(e){if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: ".concat(t)),e}return e},ye=function(e,t){if("string"!==typeof e)return e;var r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){var i,o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch(s){i=o?o.split(","):[]}return i.map((function(e){return fe(t,e)}))}return e},be=function(e){return"string"===typeof e?e.replace(" ","T"):e},ke=r(87),ge={"X-Client-Info":"realtime-js/".concat("1.7.5")},we=1e4;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(oe||(oe={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(se||(se={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(ae||(ae={})),function(e){e.websocket="websocket"}(ce||(ce={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(ue||(ue={}));var xe=function(){function e(t,r){i(this,e),this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}return s(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.tries=e.tries+1,e.callback()}),this.timerCalc(this.tries+1))}}]),e}(),_e=function(){function e(){i(this,e),this.HEADER_LENGTH=1}return s(e,[{key:"decode",value:function(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}},{key:"_binaryDecode",value:function(e){var t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}},{key:"_decodeBroadcast",value:function(e,t,r){var n=t.getUint8(1),i=t.getUint8(2),o=this.HEADER_LENGTH+2,s=r.decode(e.slice(o,o+n));o+=n;var a=r.decode(e.slice(o,o+i));return o+=i,{ref:null,topic:s,event:a,payload:JSON.parse(r.decode(e.slice(o,e.byteLength)))}}}]),e}(),Te=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:we;i(this,e),this.channel=t,this.event=r,this.payload=n,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}return s(e,[{key:"resend",value:function(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}},{key:"send",value:function(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel.joinRef()}))}},{key:"updatePayload",value:function(e){this.payload=Object.assign(Object.assign({},this.payload),e)}},{key:"receive",value:function(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}},{key:"startTimeout",value:function(){var e=this;if(!this.timeoutTimer){this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);this.channel.on(this.refEvent,(function(t){e._cancelRefEvent(),e._cancelTimeout(),e.receivedResp=t,e._matchReceive(t)})),this.timeoutTimer=setTimeout((function(){e.trigger("timeout",{})}),this.timeout)}}},{key:"trigger",value:function(e,t){this.refEvent&&this.channel.trigger(this.refEvent,{status:e,response:t})}},{key:"destroy",value:function(){this._cancelRefEvent(),this._cancelTimeout()}},{key:"_cancelRefEvent",value:function(){this.refEvent&&this.channel.off(this.refEvent)}},{key:"_cancelTimeout",value:function(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}},{key:"_matchReceive",value:function(e){var t=e.status,r=e.response;this.recHooks.filter((function(e){return e.status===t})).forEach((function(e){return e.callback(r)}))}},{key:"_hasReceived",value:function(e){return this.receivedResp&&this.receivedResp.status===e}}]),e}(),Se=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;i(this,e),this.topic=t,this.params=n,this.socket=o,this.bindings=[],this.state=se.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new Te(this,ae.join,this.params,this.timeout),this.rejoinTimer=new xe((function(){return r.rejoinUntilConnected()}),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(function(){r.state=se.joined,r.rejoinTimer.reset(),r.pushBuffer.forEach((function(e){return e.send()})),r.pushBuffer=[]})),this.onClose((function(){r.rejoinTimer.reset(),r.socket.log("channel","close ".concat(r.topic," ").concat(r.joinRef())),r.state=se.closed,r.socket.remove(r)})),this.onError((function(e){r.isLeaving()||r.isClosed()||(r.socket.log("channel","error ".concat(r.topic),e),r.state=se.errored,r.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(function(){r.isJoining()&&(r.socket.log("channel","timeout ".concat(r.topic),r.joinPush.timeout),r.state=se.errored,r.rejoinTimer.scheduleTimeout())})),this.on(ae.reply,(function(e,t){r.trigger(r.replyEventName(t),e)}))}return s(e,[{key:"rejoinUntilConnected",value:function(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}},{key:"subscribe",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(e),this.joinPush}},{key:"onClose",value:function(e){this.on(ae.close,e)}},{key:"onError",value:function(e){this.on(ae.error,(function(t){return e(t)}))}},{key:"on",value:function(e,t){this.bindings.push({event:e,callback:t})}},{key:"off",value:function(e){this.bindings=this.bindings.filter((function(t){return t.event!==e}))}},{key:"canPush",value:function(){return this.socket.isConnected()&&this.isJoined()}},{key:"push",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");var n=new Te(this,e,t,r);return this.canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}},{key:"updateJoinPayload",value:function(e){this.joinPush.updatePayload(e)}},{key:"unsubscribe",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=se.leaving;var r=function(){e.socket.log("channel","leave ".concat(e.topic)),e.trigger(ae.close,"leave",e.joinRef())};this.joinPush.destroy();var n=new Te(this,ae.leave,{},t);return n.receive("ok",(function(){return r()})).receive("timeout",(function(){return r()})),n.send(),this.canPush()||n.trigger("ok",{}),n}},{key:"onMessage",value:function(e,t,r){return t}},{key:"isMember",value:function(e){return this.topic===e}},{key:"joinRef",value:function(){return this.joinPush.ref}},{key:"rejoin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=se.joining,this.joinPush.resend(e))}},{key:"trigger",value:function(e,t,r){var n=ae.close,i=ae.error,o=ae.leave,s=ae.join;if(!(r&&[n,i,o,s].indexOf(e)>=0&&r!==this.joinRef())){var a=this.onMessage(e,t,r);if(t&&!a)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter((function(r){return"*"===r.event?e===(null===t||void 0===t?void 0:t.type):r.event===e})).map((function(e){return e.callback(a,r)}))}}},{key:"replyEventName",value:function(e){return"chan_reply_".concat(e)}},{key:"isClosed",value:function(){return this.state===se.closed}},{key:"isErrored",value:function(){return this.state===se.errored}},{key:"isJoined",value:function(){return this.state===se.joined}},{key:"isJoining",value:function(){return this.state===se.joining}},{key:"isLeaving",value:function(){return this.state===se.leaving}}]),e}(),Ee=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},Oe=function(){},je=function(){function e(t,r){var o=this;i(this,e),this.accessToken=null,this.channels=[],this.endPoint="",this.headers=ge,this.params={},this.timeout=we,this.transport=ke.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Oe,this.conn=null,this.sendBuffer=[],this.serializer=new _e,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint="".concat(t,"/").concat(ce.websocket),(null===r||void 0===r?void 0:r.params)&&(this.params=r.params),(null===r||void 0===r?void 0:r.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),(null===r||void 0===r?void 0:r.timeout)&&(this.timeout=r.timeout),(null===r||void 0===r?void 0:r.logger)&&(this.logger=r.logger),(null===r||void 0===r?void 0:r.transport)&&(this.transport=r.transport),(null===r||void 0===r?void 0:r.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs),(null===r||void 0===r?void 0:r.longpollerTimeout)&&(this.longpollerTimeout=r.longpollerTimeout),this.reconnectAfterMs=(null===r||void 0===r?void 0:r.reconnectAfterMs)?r.reconnectAfterMs:function(e){return[1e3,2e3,5e3,1e4][e-1]||1e4},this.encode=(null===r||void 0===r?void 0:r.encode)?r.encode:function(e,t){return t(JSON.stringify(e))},this.decode=(null===r||void 0===r?void 0:r.decode)?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new xe((function(){return Ee(o,void 0,void 0,(0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.disconnect();case 2:this.connect();case 3:case"end":return e.stop()}}),e,this)})))}),this.reconnectAfterMs)}return s(e,[{key:"connect",value:function(){var e=this;this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=function(){return e._onConnOpen()},this.conn.onerror=function(t){return e._onConnError(t)},this.conn.onmessage=function(t){return e.onConnMessage(t)},this.conn.onclose=function(t){return e._onConnClose(t)}))}},{key:"disconnect",value:function(e,t){var r=this;return new Promise((function(n,i){try{r.conn&&(r.conn.onclose=function(){},e?r.conn.close(e,t||""):r.conn.close(),r.conn=null,r.heartbeatTimer&&clearInterval(r.heartbeatTimer),r.reconnectTimer.reset()),n({error:null,data:!0})}catch(o){n({error:o,data:!1})}}))}},{key:"log",value:function(e,t,r){this.logger(e,t,r)}},{key:"onOpen",value:function(e){this.stateChangeCallbacks.open.push(e)}},{key:"onClose",value:function(e){this.stateChangeCallbacks.close.push(e)}},{key:"onError",value:function(e){this.stateChangeCallbacks.error.push(e)}},{key:"onMessage",value:function(e){this.stateChangeCallbacks.message.push(e)}},{key:"connectionState",value:function(){switch(this.conn&&this.conn.readyState){case oe.connecting:return ue.Connecting;case oe.open:return ue.Open;case oe.closing:return ue.Closing;default:return ue.Closed}}},{key:"isConnected",value:function(){return this.connectionState()===ue.Open}},{key:"remove",value:function(e){this.channels=this.channels.filter((function(t){return t.joinRef()!==e.joinRef()}))}},{key:"channel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Se(e,t,this);return this.channels.push(r),r}},{key:"push",value:function(e){var t=this,r=e.topic,n=e.event,i=e.payload,o=e.ref,s=function(){t.encode(e,(function(e){var r;null===(r=t.conn)||void 0===r||r.send(e)}))};this.log("push","".concat(r," ").concat(n," (").concat(o,")"),i),this.isConnected()?s():this.sendBuffer.push(s)}},{key:"onConnMessage",value:function(e){var t=this;this.decode(e.data,(function(e){var r=e.topic,n=e.event,i=e.payload,o=e.ref;(o&&o===t.pendingHeartbeatRef||n===(null===i||void 0===i?void 0:i.type))&&(t.pendingHeartbeatRef=null),t.log("receive","".concat(i.status||""," ").concat(r," ").concat(n," ").concat(o&&"("+o+")"||""),i),t.channels.filter((function(e){return e.isMember(r)})).forEach((function(e){return e.trigger(n,i,o)})),t.stateChangeCallbacks.message.forEach((function(t){return t(e)}))}))}},{key:"endPointURL",value:function(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}},{key:"makeRef",value:function(){var e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}},{key:"setAuth",value:function(e){this.accessToken=e,this.channels.forEach((function(t){e&&t.updateJoinPayload({user_token:e}),t.joinedOnce&&t.isJoined()&&t.push(ae.access_token,{access_token:e})}))}},{key:"leaveOpenTopic",value:function(e){var t=this.channels.find((function(t){return t.topic===e&&(t.isJoined()||t.isJoining())}));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}},{key:"_onConnOpen",value:function(){var e=this;this.log("transport","connected to ".concat(this.endPointURL())),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((function(){return e._sendHeartbeat()}),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach((function(e){return e()}))}},{key:"_onConnClose",value:function(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((function(t){return t(e)}))}},{key:"_onConnError",value:function(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((function(t){return t(e)}))}},{key:"_triggerChanError",value:function(){this.channels.forEach((function(e){return e.trigger(ae.error)}))}},{key:"_appendParams",value:function(e,t){if(0===Object.keys(t).length)return e;var r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return"".concat(e).concat(r).concat(n)}},{key:"_flushSendBuffer",value:function(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((function(e){return e()})),this.sendBuffer=[])}},{key:"_sendHeartbeat",value:function(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}]),e}(),Pe=function(){function e(t,r,n,o){i(this,e);var s={},a="*"===o?"realtime:".concat(n):"realtime:".concat(n,":").concat(o),c=r.Authorization.split(" ")[1];c&&(s.user_token=c),this.subscription=t.channel(a,s)}return s(e,[{key:"getPayloadRecords",value:function(e){var t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=he(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=he(e.columns,e.old_record)),t}},{key:"on",value:function(e,t){var r=this;return this.subscription.on(e,(function(e){var n={schema:e.schema,table:e.table,commit_timestamp:e.commit_timestamp,eventType:e.type,new:{},old:{},errors:e.errors};n=Object.assign(Object.assign({},n),r.getPayloadRecords(e)),t(n)})),this}},{key:"subscribe",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return this.subscription.onError((function(t){return e("SUBSCRIPTION_ERROR",t)})),this.subscription.onClose((function(){return e("CLOSED")})),this.subscription.subscribe().receive("ok",(function(){return e("SUBSCRIBED")})).receive("error",(function(t){return e("SUBSCRIPTION_ERROR",t)})).receive("timeout",(function(){return e("RETRYING_AFTER_TIMEOUT")})),this.subscription}}]),e}(),Ze=function(e){u(r,e);var t=d(r);function r(e,n){var o,s=n.headers,a=void 0===s?{}:s,c=n.schema,u=n.realtime,h=n.table,l=n.fetch,f=n.shouldThrowOnError;return i(this,r),(o=t.call(this,e,{headers:a,schema:c,fetch:l,shouldThrowOnError:f}))._subscription=null,o._realtime=u,o._headers=a,o._schema=c,o._table=h,o}return s(r,[{key:"on",value:function(e,t){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new Pe(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(e,t)}}]),r}(ee),Re=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},Ae=function(e){return e.msg||e.message||e.error_description||e.error||JSON.stringify(e)},Ce=function(e,t){if("function"!==typeof e.json)return t(e);e.json().then((function(r){return t({message:Ae(r),status:(null===e||void 0===e?void 0:e.status)||500})}))},Ie=function(e,t,r,n){var i={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};function Ue(e,t,r,i,o,s){return Re(this,void 0,void 0,(0,n.Z)().mark((function a(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,a){e(r,Ie(t,i,o,s)).then((function(e){if(!e.ok)throw e;return(null===i||void 0===i?void 0:i.noResolveJson)?n(e):e.json()})).then((function(e){return n(e)})).catch((function(e){return Ce(e,a)}))})));case 1:case"end":return n.stop()}}),a)})))}function Ne(e,t,r,i){return Re(this,void 0,void 0,(0,n.Z)().mark((function o(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ue(e,"GET",t,r,i));case 1:case"end":return n.stop()}}),o)})))}function Le(e,t,r,i,o){return Re(this,void 0,void 0,(0,n.Z)().mark((function s(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ue(e,"POST",t,i,o,r));case 1:case"end":return n.stop()}}),s)})))}function De(e,t,r,i,o){return Re(this,void 0,void 0,(0,n.Z)().mark((function s(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ue(e,"PUT",t,i,o,r));case 1:case"end":return n.stop()}}),s)})))}function Ge(e,t,r,i,o){return Re(this,void 0,void 0,(0,n.Z)().mark((function s(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ue(e,"DELETE",t,i,o,r));case 1:case"end":return n.stop()}}),s)})))}var Me=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},Be=function(e){var t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return Me(void 0,void 0,void 0,(0,n.Z)().mark((function e(){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(255).then(r.t.bind(r,255,23));case 2:return e.next=4,(i=e.sent).fetch.apply(i,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))}:fetch),function(){return t.apply(void 0,arguments)}},Fe=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},He={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Je={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},ze=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;i(this,e),this.url=t,this.headers=r,this.bucketId=n,this.fetch=Be(o)}return s(e,[{key:"uploadOrUpdate",value:function(e,t,r,i){return Fe(this,void 0,void 0,(0,n.Z)().mark((function o(){var s,a,c,u,h,l,f;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=Object.assign(Object.assign({},Je),i),c=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(a.upsert)}),"undefined"!==typeof Blob&&r instanceof Blob?((s=new FormData).append("cacheControl",a.cacheControl),s.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(s=r).append("cacheControl",a.cacheControl):(s=r,c["cache-control"]="max-age=".concat(a.cacheControl),c["content-type"]=a.contentType),u=this._removeEmptyFolders(t),h=this._getFinalPath(u),n.next=8,this.fetch("".concat(this.url,"/object/").concat(h),{method:e,body:s,headers:c});case 8:if(!(l=n.sent).ok){n.next=13;break}return n.abrupt("return",{data:{Key:h},error:null});case 13:return n.next=15,l.json();case 15:return f=n.sent,n.abrupt("return",{data:null,error:f});case 17:n.next=22;break;case 19:return n.prev=19,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 22:case"end":return n.stop()}}),o,this,[[0,19]])})))}},{key:"upload",value:function(e,t,r){return Fe(this,void 0,void 0,(0,n.Z)().mark((function i(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.uploadOrUpdate("POST",e,t,r));case 1:case"end":return n.stop()}}),i,this)})))}},{key:"update",value:function(e,t,r){return Fe(this,void 0,void 0,(0,n.Z)().mark((function i(){return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.uploadOrUpdate("PUT",e,t,r));case 1:case"end":return n.stop()}}),i,this)})))}},{key:"move",value:function(e,t){return Fe(this,void 0,void 0,(0,n.Z)().mark((function r(){var i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Le(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers});case 3:return i=r.sent,r.abrupt("return",{data:i,error:null});case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",{data:null,error:r.t0});case 10:case"end":return r.stop()}}),r,this,[[0,7]])})))}},{key:"copy",value:function(e,t){return Fe(this,void 0,void 0,(0,n.Z)().mark((function r(){var i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Le(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers});case 3:return i=r.sent,r.abrupt("return",{data:i,error:null});case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",{data:null,error:r.t0});case 10:case"end":return r.stop()}}),r,this,[[0,7]])})))}},{key:"createSignedUrl",value:function(e,t){return Fe(this,void 0,void 0,(0,n.Z)().mark((function r(){var i,o,s;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,i=this._getFinalPath(e),r.next=4,Le(this.fetch,"".concat(this.url,"/object/sign/").concat(i),{expiresIn:t},{headers:this.headers});case 4:return o=r.sent,s="".concat(this.url).concat(o.signedURL),o={signedURL:s},r.abrupt("return",{data:o,error:null,signedURL:s});case 10:return r.prev=10,r.t0=r.catch(0),r.abrupt("return",{data:null,error:r.t0,signedURL:null});case 13:case"end":return r.stop()}}),r,this,[[0,10]])})))}},{key:"createSignedUrls",value:function(e,t){return Fe(this,void 0,void 0,(0,n.Z)().mark((function r(){var i,o=this;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Le(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers});case 3:return i=r.sent,r.abrupt("return",{data:i.map((function(e){return Object.assign(Object.assign({},e),{signedURL:e.signedURL?"".concat(o.url).concat(e.signedURL):null})})),error:null});case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",{data:null,error:r.t0});case 10:case"end":return r.stop()}}),r,this,[[0,7]])})))}},{key:"download",value:function(e){return Fe(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,i,o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=this._getFinalPath(e),t.next=4,Ne(this.fetch,"".concat(this.url,"/object/").concat(r),{headers:this.headers,noResolveJson:!0});case 4:return i=t.sent,t.next=7,i.blob();case 7:return o=t.sent,t.abrupt("return",{data:o,error:null});case 11:return t.prev=11,t.t0=t.catch(0),t.abrupt("return",{data:null,error:t.t0});case 14:case"end":return t.stop()}}),t,this,[[0,11]])})))}},{key:"getPublicUrl",value:function(e){try{var t=this._getFinalPath(e),r="".concat(this.url,"/object/public/").concat(t);return{data:{publicURL:r},error:null,publicURL:r}}catch(n){return{data:null,error:n,publicURL:null}}}},{key:"remove",value:function(e){return Fe(this,void 0,void 0,(0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ge(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers});case 3:return r=t.sent,t.abrupt("return",{data:r,error:null});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{data:null,error:t.t0});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"list",value:function(e,t,r){return Fe(this,void 0,void 0,(0,n.Z)().mark((function i(){var o,s;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=Object.assign(Object.assign(Object.assign({},He),t),{prefix:e||""}),n.next=4,Le(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),o,{headers:this.headers},r);case 4:return s=n.sent,n.abrupt("return",{data:s,error:null});case 8:return n.prev=8,n.t0=n.catch(0),n.abrupt("return",{data:null,error:n.t0});case 11:case"end":return n.stop()}}),i,this,[[0,8]])})))}},{key:"_getFinalPath",value:function(e){return"".concat(this.bucketId,"/").concat(e)}},{key:"_removeEmptyFolders",value:function(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}]),e}(),qe={"X-Client-Info":"storage-js/".concat("1.7.3")},Ke=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},We=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;i(this,e),this.url=t,this.headers=Object.assign(Object.assign({},qe),r),this.fetch=Be(n)}return s(e,[{key:"listBuckets",value:function(){return Ke(this,void 0,void 0,(0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ne(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers});case 3:return t=e.sent,e.abrupt("return",{data:t,error:null});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{data:null,error:e.t0});case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"getBucket",value:function(e){return Ke(this,void 0,void 0,(0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ne(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers});case 3:return r=t.sent,t.abrupt("return",{data:r,error:null});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{data:null,error:t.t0});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"createBucket",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return Ke(this,void 0,void 0,(0,n.Z)().mark((function r(){var i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Le(this.fetch,"".concat(this.url,"/bucket"),{id:e,name:e,public:t.public},{headers:this.headers});case 3:return i=r.sent,r.abrupt("return",{data:i.name,error:null});case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",{data:null,error:r.t0});case 10:case"end":return r.stop()}}),r,this,[[0,7]])})))}},{key:"updateBucket",value:function(e,t){return Ke(this,void 0,void 0,(0,n.Z)().mark((function r(){var i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,De(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public},{headers:this.headers});case 3:return i=r.sent,r.abrupt("return",{data:i,error:null});case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",{data:null,error:r.t0});case 10:case"end":return r.stop()}}),r,this,[[0,7]])})))}},{key:"emptyBucket",value:function(e){return Ke(this,void 0,void 0,(0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Le(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers});case 3:return r=t.sent,t.abrupt("return",{data:r,error:null});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{data:null,error:t.t0});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"deleteBucket",value:function(e){return Ke(this,void 0,void 0,(0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ge(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers});case 3:return r=t.sent,t.abrupt("return",{data:r,error:null});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{data:null,error:t.t0});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}}]),e}(),Ve=function(e){u(r,e);var t=d(r);function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return i(this,r),t.call(this,e,n,o)}return s(r,[{key:"from",value:function(e){return new ze(this.url,this.headers,e,this.fetch)}}]),r}(We),Ye=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},$e=function(e){var t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return Ye(void 0,void 0,void 0,(0,n.Z)().mark((function e(){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(255).then(r.t.bind(r,255,23));case 2:return e.next=4,(i=e.sent).fetch.apply(i,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))}:fetch),function(){return t.apply(void 0,arguments)}},Xe=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},Qe=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.headers,o=void 0===n?{}:n,s=r.customFetch;i(this,e),this.url=t,this.headers=o,this.fetch=$e(s)}return s(e,[{key:"setAuth",value:function(e){this.headers.Authorization="Bearer ".concat(e)}},{key:"invoke",value:function(e,t){return Xe(this,void 0,void 0,(0,n.Z)().mark((function r(){var i,o,s,a,c,u,h;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,o=(i=null!==t&&void 0!==t?t:{}).headers,s=i.body,r.next=4,this.fetch("".concat(this.url,"/").concat(e),{method:"POST",headers:Object.assign({},this.headers,o),body:s});case 4:if(a=r.sent,!(c=a.headers.get("x-relay-error"))||"true"!==c){r.next=13;break}return r.t0=Error,r.next=10,a.text();case 10:return r.t1=r.sent,r.t2=new r.t0(r.t1),r.abrupt("return",{data:null,error:r.t2});case 13:if((h=(null!==t&&void 0!==t?t:{}).responseType)&&"json"!==h){r.next=20;break}return r.next=17,a.json();case 17:u=r.sent,r.next=35;break;case 20:if("arrayBuffer"!==h){r.next=26;break}return r.next=23,a.arrayBuffer();case 23:u=r.sent,r.next=35;break;case 26:if("blob"!==h){r.next=32;break}return r.next=29,a.blob();case 29:u=r.sent,r.next=35;break;case 32:return r.next=34,a.text();case 34:u=r.sent;case 35:return r.abrupt("return",{data:u,error:null});case 38:return r.prev=38,r.t3=r.catch(0),r.abrupt("return",{data:null,error:r.t3});case 41:case"end":return r.stop()}}),r,this,[[0,38]])})))}}]),e}(),et=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},tt={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:a},rt=function(){function e(t,r,n){if(i(this,e),this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");var o=t.replace(/\/$/,""),s=Object.assign(Object.assign({},tt),n);if(this.restUrl="".concat(o,"/rest/v1"),this.realtimeUrl="".concat(o,"/realtime/v1").replace("http","ws"),this.authUrl="".concat(o,"/auth/v1"),this.storageUrl="".concat(o,"/storage/v1"),o.match(/(supabase\.co)|(supabase\.in)/)){var c=o.split(".");this.functionsUrl="".concat(c[0],".functions.").concat(c[1],".").concat(c[2])}else this.functionsUrl="".concat(o,"/functions/v1");this.schema=s.schema,this.multiTab=s.multiTab,this.fetch=s.fetch,this.headers=Object.assign(Object.assign({},a),null===n||void 0===n?void 0:n.headers),this.shouldThrowOnError=s.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(s),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},s.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}return s(e,[{key:"functions",get:function(){return new Qe(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}},{key:"storage",get:function(){return new Ve(this.storageUrl,this._getAuthHeaders(),this.fetch)}},{key:"from",value:function(e){var t="".concat(this.restUrl,"/").concat(e);return new Ze(t,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:e,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}},{key:"rpc",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.head,i=void 0!==n&&n,o=r.count,s=void 0===o?null:o,a=this._initPostgRESTClient();return a.rpc(e,t,{head:i,count:s})}},{key:"removeAllSubscriptions",value:function(){return et(this,void 0,void 0,(0,n.Z)().mark((function e(){var t,r,i,o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getSubscriptions().slice(),r=t.map((function(e){return o.removeSubscription(e)})),e.next=4,Promise.all(r);case 4:return i=e.sent,e.abrupt("return",i.map((function(e,r){var n=e.error;return{data:{subscription:t[r]},error:n}})));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"removeSubscription",value:function(e){return et(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,i,o,s;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._closeSubscription(e);case 2:if(r=t.sent,i=r.error,o=this.getSubscriptions(),s=o.filter((function(e){return e.isJoined()})).length,0!==o.length){t.next=9;break}return t.next=9,this.realtime.disconnect();case 9:return t.abrupt("return",{data:{openSubscriptions:s},error:i});case 10:case"end":return t.stop()}}),t,this)})))}},{key:"_closeSubscription",value:function(e){return et(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,i,o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null,e.isClosed()){t.next=7;break}return t.next=4,this._unsubscribeSubscription(e);case 4:i=t.sent,o=i.error,r=o;case 7:return this.realtime.remove(e),t.abrupt("return",{error:r});case 9:case"end":return t.stop()}}),t,this)})))}},{key:"_unsubscribeSubscription",value:function(e){return new Promise((function(t){e.unsubscribe().receive("ok",(function(){return t({error:null})})).receive("error",(function(e){return t({error:e})})).receive("timeout",(function(){return t({error:new Error("timed out")})}))}))}},{key:"getSubscriptions",value:function(){return this.realtime.channels}},{key:"_initSupabaseAuthClient",value:function(e){var t=e.autoRefreshToken,r=e.persistSession,n=e.detectSessionInUrl,i=e.localStorage,o=e.headers,s=e.fetch,a=e.cookieOptions,c=e.multiTab,u={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new z({url:this.authUrl,headers:Object.assign(Object.assign({},o),u),autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,localStorage:i,fetch:s,cookieOptions:a,multiTab:c})}},{key:"_initRealtimeClient",value:function(e){return new je(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({},null===e||void 0===e?void 0:e.params),{apikey:this.supabaseKey})}))}},{key:"_initPostgRESTClient",value:function(){return new ie(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}},{key:"_getAuthHeaders",value:function(){var e,t,r=Object.assign({},this.headers),n=null!==(t=null===(e=this.auth.session())||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey;return r.apikey=this.supabaseKey,r.Authorization=r.Authorization||"Bearer ".concat(n),r}},{key:"_listenForMultiTabEvents",value:function(){var e=this;if(!this.multiTab||"undefined"===typeof window||!(null===window||void 0===window?void 0:window.addEventListener))return null;try{return null===window||void 0===window?void 0:window.addEventListener("storage",(function(t){var r,n,i;if("supabase.auth.token"===t.key){var o=JSON.parse(String(t.newValue)),s=null!==(n=null===(r=null===o||void 0===o?void 0:o.currentSession)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,a=null===(i=e.auth.session())||void 0===i?void 0:i.access_token;s?!a&&s?e._handleTokenChanged("SIGNED_IN",s,"STORAGE"):a!==s&&e._handleTokenChanged("TOKEN_REFRESHED",s,"STORAGE"):e._handleTokenChanged("SIGNED_OUT",s,"STORAGE")}}))}catch(t){return console.error("_listenForMultiTabEvents",t),null}}},{key:"_listenForAuthEvents",value:function(){var e=this;return this.auth.onAuthStateChange((function(t,r){e._handleTokenChanged(t,null===r||void 0===r?void 0:r.access_token,"CLIENT")})).data}},{key:"_handleTokenChanged",value:function(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===t?"SIGNED_OUT"!==e&&"USER_DELETED"!==e||(this.realtime.setAuth(this.supabaseKey),"STORAGE"==r&&this.auth.signOut()):(this.realtime.setAuth(t),"STORAGE"==r&&this.auth.setAuth(t),this.changedAccessToken=t)}}]),e}(),nt=function(e,t,r){return new rt(e,t,r)}},210:function(e){var t=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},87:function(e,t,r){var n;if("object"===typeof globalThis)n=globalThis;else try{n=r(210)}catch(a){}finally{if(n||"undefined"===typeof window||(n=window),!n)throw new Error("Could not determine global this")}var i=n.WebSocket||n.MozWebSocket,o=r(496);function s(e,t){return t?new i(e,t):new i(e)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(s,e,{get:function(){return i[e]}})})),e.exports={w3cwebsocket:i?s:null,version:o}},496:function(e,t,r){e.exports=r(794).version},907:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:function(){return n}})},861:function(e,t,r){"use strict";function n(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(u){return void r(u)}a.done?t(c):Promise.resolve(c).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var s=e.apply(t,r);function a(e){n(s,i,o,a,c,"next",e)}function c(e){n(s,i,o,a,c,"throw",e)}a(void 0)}))}}r.d(t,{Z:function(){return i}})},683:function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.d(t,{Z:function(){return o}})},165:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(2);function i(){i=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(j){u=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var i=t&&t.prototype instanceof d?t:d,o=Object.create(i.prototype),s=new S(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return O()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=x(s,r);if(a){if(a===f)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,s),o}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(j){return{type:"throw",arg:j}}}e.wrap=h;var f={};function d(){}function p(){}function v(){}var m={};u(m,s,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(E([])));b&&b!==t&&r.call(b,s)&&(m=b);var k=v.prototype=d.prototype=Object.create(m);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(o,s,a,c){var u=l(e[o],e,s);if("throw"!==u.type){var h=u.arg,f=h.value;return f&&"object"==(0,n.Z)(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){i("next",e,a,c)}),(function(e){i("throw",e,a,c)})):t.resolve(f).then((function(e){h.value=e,a(h)}),(function(e){return i("throw",e,a,c)}))}c(u.arg)}var o;this._invoke=function(e,r){function n(){return new t((function(t,n){i(e,r,t,n)}))}return o=o?o.then(n,n):n()}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function E(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return p.prototype=v,u(k,"constructor",v),u(v,"constructor",p),p.displayName=u(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},g(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new w(h(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},g(k),u(k,c,"Generator"),u(k,s,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=E,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}},885:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(181);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(c){a=!0,i=c}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}(e,t)||(0,n.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:function(){return n}})},181:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(907);function i(e,t){if(e){if("string"===typeof e)return(0,n.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}},794:function(e){"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=241.22d55c82.chunk.js.map